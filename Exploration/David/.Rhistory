labels, lwd=1, lty=c(1, 1), col=colors )
labels <- c("simulated curve","normal")
colors <- c("red", "black")
legend("topright", inset=.05, title="Distributions",
labels, lwd=1, lty=c(1, 1), col=colors )
u <-runif(1000, min = 0, max = 1)
y <- -log(1-u)
y_range <- seq(0,max(y),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Comparison of Expo. Distributions")
lines(sort(y,decreasing=TRUE),sort(u,decreasing=FALSE), lwd=1, col="red")
labels <- c("simulated curve","Expo.")
colors <- c("red", "black")
legend("topright", inset=.05, title="Distributions",
labels, lwd=1, lty=c(1, 2), col=colors )
u <-runif(1000, min = 0, max = 1)
y <- (-log(1-u))^(1/3)
y_range <- seq(0,max(y),length=1000)
hy <- dweibull(y_range, shape=3, scale = 1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Comparison of Weibull Distributions")
lines(sort(y,decreasing=TRUE),sort(u,decreasing=FALSE), lwd=1, col="red")
labels <- c("simulated curve","Weibull")
colors <- c("red", "black")
legend("topright", inset=.05, title="Distributions",
labels, lwd=1, lty=c(1, 2), col=colors )
u <-runif(1000, min = 0, max = 1)
y <- (-log(1-u))^(1/3)
y_range <- seq(0,max(y),length=1000)
hy <- dweibull(y_range, shape=3, scale = 1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Comparison of Weibull Distributions")
u <-runif(1000, min = 0, max = 1)
y <- (-log(1-u))^(1/3)
y_range <- seq(0,max(y),length=1000)
max(y)
hy <- dweibull(y_range, shape=3, scale = 1)
hy
range(hy)
?dweibull
u <- sort(u)
u <-runif(1000, min = 0, max = 1)
u <- sort(u)
y <- (-log(1-u))^(1/3)
y_range <- seq(0,max(y),length=1000)
hy <- dweibull(y_range, shape=3, scale = 1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Comparison of Weibull Distributions")
lines(y,u, lwd=1, col="red")
u <-runif(1000, min = 0, max = 1)
u <- sort(u)
y <- (-log(1-u))^(1/3)
y_range <- seq(0,max(y),length=1000)
hy <- dweibull(y_range, shape=3, scale = 1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Comparison of Weibull Distributions")
install.packages("Renext")
library(Renext)
x.new <- rweibull(1000, shape = 3, scale = 1)
weibplot(x.new, main = "Classical Weibull plot")
weibplot(x.new, shape = c(0.9, 1.3), scale = 1)
rw <- rweibull(1000, scale=1, shape=1.5)
plot(density(rw, bw=0.5, cut=0), lwd=2,
xlim=c(0,5),col="steelblue")
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=2,
xlim=c(0,5),col="steelblue")
plot(density(rw, bw=0.5, cut=0), lwd=2,col="steelblue")
?density
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
u <-runif(1000, min = 0, max = 1)
u <- sort(u)
y <- (-log(1-u))^(1/3)
range(y)
y_range <- seq(0,max(y),length=1000)
lines(y,u, lwd=1, col="red")
?lines
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
u <-runif(1000, min = 0, max = 1)
u <- sort(u)
y <- (-log(1-u))^(1/3)
lines(u,y, lwd=1, col="red")
range(u)
range(y)
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
u <-runif(1000, min = 0, max = 1)
u <- sort(u)
v <- 1-u
y <- (-log(v))^(1/3)
lines(v,y, lwd=1, col="red")
lines(y,v, lwd=1, col="red")
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
u <-runif(1000, min = 0, max = 1)
u <- sort(u)
v <- 1-u
u <-runif(1000, min = 0, max = 1)
v <- 1-u
v <- sort(v)
y <- (-log(v))^(1/3)
y_range <- seq(0,max(y),length=1000)
lines(y,v, lwd=1, col="red")
range(y)
range(v)
?line
y_simu <- (-log(v))^(1/3)
y_simu <- (-log(v))^(1/3)
y_range <- seq(0,max(y),length=1000)
lines(x=y_simu,y=v, lwd=1, col="red")
y_simu
u <-runif(1000, min = 0, max = 1)
y <- -log(1-u)
y_range <- seq(0,max(y),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Comparison of Expo. Distributions")
lines(sort(y,decreasing=TRUE),sort(u,decreasing=FALSE), lwd=1, col="red")
labels <- c("simulated curve","Expo.")
colors <- c("red", "black")
legend("topright", inset=.05, title="Distributions",
labels, lwd=1, lty=c(1, 2), col=colors )
u <-runif(1000, min = 0, max = 1)
y <- -log(1-u)
y_range <- seq(0,max(y),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Comparison of Expo. Distributions")
lines(sort(y,decreasing=TRUE),sort(u,decreasing=FALSE), lwd=1, col="steelblue")
labels <- c("simulated curve","Expo.")
colors <- c("steelblue", "black")
legend("topright", inset=.05, title="Distributions",
labels, lwd=1, lty=c(1, 2), col=colors )
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
range(rw)
range(density(rw, bw=0.5, cut=0))
density(rw, bw=0.5, cut=0)
rexpo <- rexpo(1000, rate=1)
plot(density(rexpo, bw=0.5, cut=0), lwd=1.5,col="steelblue")
rexpo <- rexpo(1000, rate=1)
?rexp
rexpo <- rexp(1000, rate=1)
plot(density(rexpo, bw=0.5, cut=0), lwd=1.5,col="steelblue")
lines(sort(y,decreasing=TRUE),sort(u,decreasing=FALSE), lwd=1, col="red")
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
u <-runif(1000, min = 0, max = 1)
v <- 1-u
v <- sort(v)
y_simu <- (-log(v))^(1/3)
lines(x=y_simu,y=v, lwd=1, col="red")
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
u <-runif(1000, min = 0, max = 1)
v <- 1-u
y_simu <- (-log(v))^(1/3)
lines(x=y_simu,y=v, lwd=1, col="red")
hist(x = v, y = y_simu, breaks = 20)
hist(y = y_simu, breaks = 20)
u <-runif(1000, min = 0, max = 1)
v <- 1-u
y_simu <- (-log(v))^(1/3)
hist(y_simu, breaks = 20)
den <- density(y_simu)
plot(den)
hist(y_simu, breaks = 20)
hist(y_simu, breaks = 200)
plot(den)
hist(y_simu, breaks = 200)
u <-runif(1000, min = 0, max = 1)
y <- -log(1-u)
y_range <- seq(0,max(y),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Comparison of Expo. Distributions")
lines(sort(y,decreasing=TRUE),sort(u,decreasing=FALSE), lwd=1, col="red")
labels <- c("simulated curve","Expo.")
colors <- c("red", "black")
legend("topright", inset=.05, title="Distributions",
labels, lwd=1, lty=c(1, 2), col=colors )
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
u <-runif(1000, min = 0, max = 1)
v <- 1-u
y_simu <- (-log(1-u))^(1/3)
plot(den)
hist(y_simu, breaks = 200)
plot(den)
range(y_simu)
points(x=y_simu,y=u)
hist(y_simu, breaks = 200)
hist(y_simu, breaks = 50)
plot(den)
u <-runif(1000, min = 0, max = 1)
y <- -log(1-u)
y_range <- seq(0,max(y),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Comparison of Expo. Distributions")
hist(y, breaks = 50)
par(mfrow=c(1,2))
u <-runif(1000, min = 0, max = 1)
y <- -log(1-u)
y_range <- seq(0,max(y),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Expo. Distributions")
hist(y, breaks = 50)
u <-runif(1000, min = 0, max = 1)
y <- -log(1-u)
y_range <- seq(0,max(y),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Expo. Distributions")
hist(y, breaks = 50)
par(mfrow=c(2,1))
u <-runif(1000, min = 0, max = 1)
y <- -log(1-u)
y_range <- seq(0,max(y),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Expo. Distributions")
hist(y, breaks = 50,main="Histogram of simulated Values")
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
rw <- rweibull(1000, scale=1, shape=3)
plot(density(rw, bw=0.5, cut=0), lwd=1.5,col="steelblue")
u <-runif(1000, min = 0, max = 1)
y_simu <- (-log(1-u))^(1/3)
den <- density(y_simu)
plot(den)
hist(y_simu, breaks = 50)
hist(y, breaks = 50,main="Histogram of simulated Values")
u <-runif(1000, min = 0, max = 1)
y_simu <- (-log(1-u))^(1/3)
den <- density(y_simu)
plot(den)
line(x=den$x,y=den$y)
?line
lines(x=den$x,y=den$y)
lines(x=den$x,y=den$y,col="steelblue")
?dweibull()
y_range <- seq(0,max(y_simu),length=1000)
plot(y_range, dweibull(y_range,shape=3,scale=1), type="l", lty=2, xlab="y value",
ylab="Density", main="Weibull Distributions")
lines(x=den$x,y=den$y,col="steelblue")
layout(1)
u <-runif(1000, min = 0, max = 1)
y <- -log(1-u)
u <-runif(1000, min = 0, max = 1)
y_simu <- -log(1-u)
y_range <- seq(0,max(y),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Expo. Distributions")
den <- density(y_simu)
lines(x=den$x,y=den$y,col="steelblue")
hist(y, breaks = 50,main="Histogram of simulated Values")
u <-runif(1000, min = 0, max = 1)
y_simu <- -log(1-u)
y_range <- seq(0,max(y_simu),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Expo. Distributions")
den <- density(y_simu)
lines(x=den$x,y=den$y,col="steelblue")
?density
u <-runif(1000, min = 0, max = 1)
y_simu <- -log(1-u)
# true distribution
y_range <- seq(0,max(y_simu),length=1000)
hy <- dexp(y_range,rate=1)
#plot
plot(y_range, hy, type="l", lty=2, xlab="y value",
ylab="Density", main="Expo. Distributions")
den <- density(y_simu,cut=0.05)
lines(x=den$x,y=den$y,col="steelblue")
u <-runif(1000, min = 0, max = 1)
y_simu <- (-log(1-u))^(1/3)
y_range <- seq(0,max(y_simu),length=1000)
plot(y_range, dweibull(y_range,shape=3,scale=1), type="l", lty=2, xlab="y value",
ylab="Density", main="Weibull Distributions")
den <- density(y_simu)
lines(x=den$x,y=den$y,col="steelblue")
u <-runif(1000, min = 0, max = 1)
y_simu <- -log(1-u)
y_range <- seq(0,max(y_simu),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",ylab="Density", main="Expo. Distributions")
plot(y_range, hy, type="l", lty=2, xlab="y value",ylab="Density", main="Expo. Distributions")
u <-runif(1000, min = 0, max = 1)
y_simu <- -log(1-u)
den <- density(y_simu,cut=0.05)
y_range <- seq(0,max(y_simu),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",ylab="Density", main="Expo. Distributions")
lines(x=den$x,y=den$y,col="steelblue")
hist(y, breaks = 50,main="Histogram of simulated Values")
par(mfrow=c(2,1))
u <-runif(1000, min = 0, max = 1)
y_simu <- -log(1-u)
y_range <- seq(0,max(y_simu),length=1000)
hy <- dexp(y_range,rate=1)
plot(y_range, hy, type="l", lty=2, xlab="y value",ylab="Density", main="Expo. Distributions")
hist(y_simu, breaks = 50,main="Histogram of simulated Values")
y_range <- seq(0,max(y_simu),length=1000)
plot(y_range, dweibull(y_range,shape=3,scale=1), type="l", lty=2, xlab="y value",
ylab="Density", main="Weibull Distributions")
hist(y_simu, breaks = 50)
u <-runif(1000, min = 0, max = 1)
y_simu <- (-log(1-u))^(1/3)
y_range <- seq(0,max(y_simu),length=1000)
plot(y_range, dweibull(y_range,shape=3,scale=1), type="l", lty=2, xlab="y value",
ylab="Density", main="Weibull Distributions")
hist(y_simu, breaks = 50)
pi
y_simu <- tan(pi*(u-0.5))
dcauchy()
?dcauchy
y_range <- seq(0,max(y_simu),length=1000)
plot(y_range, dcauchy(y_range,location = 0, scale = 1), type="l", lty=2, xlab="y value",
ylab="Density", main="Weibull Distributions")
hist(y_simu, breaks = 50)
u <-runif(1000, min = 0.5, max = 1)
y_simu <- tan(pi*(u-0.5))
y_range <- seq(0,max(y_simu),length=1000)
plot(y_range, dcauchy(y_range,location = 0, scale = 1), type="l", lty=2, xlab="y value",
ylab="Density", main="Cauchy Distributions")
hist(y_simu, breaks = 50)
u <-runif(1000, min = 0.5, max = 1)
y_simu <- tan(pi*(u-0.5))
y_range <- seq(0,max(y_simu),length=1000)
plot(y_range, dcauchy(y_range,location = 0, scale = 1), type="l", lty=2, xlab="y value",
ylab="Density", main="Cauchy Distributions")
hist(y_simu, breaks = 50)
u1 <- runif(1000,0,1)
u2 <- runif(1000,0,1)
x1  <- -2*(log(u1)+log(u2))
v1 <- runif(1000,0,1)
v2 <- runif(1000,0,1)
v3 <- runif(1000,0,1)
x2  <- -2*(log(v1)+log(v2)+log(32))
f <- (x1/4)/(x2/6)
y_range <- seq(0,max(f),length=1000)
y_range <- seq(0,max(f),length=1000)
plot(y_range, df(y_range,4, 6), type="l", lty=2, xlab="y value",
ylab="Density", main="F Distributions")
hist(f, breaks = 50)
?hist
hist(f, freq=F,main="F Distributions",break=50)
hist(f, freq=FALSE,main="F Distributions",break=50)
hist(f, freq=FALSE,main="F Distributions",breaks=50)
hist(f, freq=FALSE,main="F Distributions",breaks=10)
hist(f, freq=FALSE,main="F Distributions",breaks=50,ylim=c(0,0.7))
hist(f, freq=FALSE,main="F Distributions",breaks=50,ylim=c(0,0.1))
hist(f, freq=FALSE,main="F Distributions",breaks=50,ylim=c(0,0.05))
library("recommenderlab")
install.packages("recommenderlab")
library("recommenderlab")
suppressPackageStartupMessages({
library(recommenderlab)
library(dplyr)
library(ggplot2)
})
data(MovieLense)
MovieLense
train <- MovieLense[1:900]
u <- MovieLense[901]
u
as(u, "matrix")[,1:5]
?Recommender
r <- Recommender(train, method = "UBCF")
r
recom <- predict(r, u, n = 5)
recom
as(recom, "list")
scheme <- evaluationScheme(train, method = "cross", k =4,
given = 10, goodRating=3)
algorithms <- list(
`random items` = list(name = "RANDOM", param = NULL),
`popular items` = list(name = "POPULAR", param = NULL),
`user-based CF` = list(name = "UBCF",
param = list(method = "Cosine", nn = 50)),
`item-based CF` = list(name = "IBCF",
param = list(method = "Cosine", k = 50)))
results <- evaluate(scheme, algorithms,
n = c(1, 3, 5, 10, 15, 20, 50))
plot(results, annotate = c(1, 3), legend = "right")
plot(results, annotate = c(1, 3), legend = "topright")
suppressPackageStartupMessages({
library(dplyr)
library(ggplot2)
library(arm)
library(gridExtra)
library(broom)
})
cd4data <-read.table(file=file.path("data","cd4.txt"),header=TRUE)
udata<- read.delim("http://files.grouplens.org/datasets/movielens/ml-100k/u.data")
head(udata)
udata<- read.table("http://files.grouplens.org/datasets/movielens/ml-100k/u.data")
head(udata)
names(udata)
names(udata) <- c("User_id","Item_id","Rating","Timestamp")
head(udata)
udata<-udata[1:3,]
udata<- read.table("http://files.grouplens.org/datasets/movielens/ml-100k/u.data")
names(udata) <- c("User_id","Item_id","Rating","Timestamp")
head(udata)
udata<-udata[,1:3]
head(udata)
udata <- data.frame(udata)
save(udata,file="udata.Rda")
save(udata,file="udata.Rda")
getwd()
load(./data/udata.Rda)
load("./data/udata.Rda")
setwd("~/GitHub/P2_Recom_Sys_MovieLens/Exploration/David")
head(udata)
length(unique(udata$User_id))
Unique_id <-unique(udata$User_id)
Unique_
id_count<- function(id) {
return(dim(udata[udata$User_id==id ,])[1])
}
Unique_id <-unique(udata$User_id)
id_count<- function(id) {
return(dim(udata[udata$User_id==id ,])[1])
}
count_result<-sapply(X=Unique_id,FUN=id_count)
table(count_result)
suppressPackageStartupMessages({
library(recommenderlab)
library(dplyr)
library(ggplot2)
})
setwd("~/GitHub/P2_Recom_Sys_MovieLens/Exploration/David")
load("./data/udata.Rda")
Unique_id <-unique(udata$User_id)
id_count<- function(id) {
return(dim(udata[udata$User_id==id ,])[1])
}
count_result<-sapply(X=Unique_id,FUN=id_count)
table(count_result)
count_result_df <- data.frame(table(count_result))
View(count_result_df)
ggplot(count_result_df, aes(count_result))
ggplot(count_result_df, aes(count_result))+geom_histogram(bindwidth=2)
ggplot(count_result_df, aes(count_result))+geom_histogram((binwidth = 5)
)
ggplot(count_result_df, aes(count_result)) +geom_histogram((binwidth = 5)
)
ggplot(count_result_df, aes(count_result)) +geom_histogram(binwidth = 5)
count_result
count_result_df <- data.frame(count_result)
View(count_result_df)
ggplot(count_result_df, aes(count_result)) +geom_histogram(binwidth = 5)
table(count_result)
ggplot(count_result_df, aes(count_result)) +geom_histogram(binwidth = 3)
ggplot(count_result_df, aes(count_result)) +geom_histogram(binwidth = 1)+
ggtitle("Histogram of movie counts(bw=3)")
ggplot(count_result_df, aes(count_result)) +geom_histogram(binwidth = 3)+
ggtitle("Histogram of movie counts(bw=3)")
median(table(count_result))
ggplot(count_result_df, aes(count_result)) +geom_histogram(binwidth = 3)+
geom_vline(xintercept = 146,colour="steelblue",linetype = "longdash")+
ggtitle("Histogram of movie counts(bw=3)")
?ggsave
ggsave("./image/week7_hist.png")
ggsave("./image/week7_hist.png",plot=p1 )
p1 <-ggplot(count_result_df, aes(count_result)) +geom_histogram(binwidth = 3)+
geom_vline(xintercept = 146,colour="steelblue",linetype = "longdash")+
ggtitle("Histogram of movie counts(bw=3)")
ggsave("./image/week7_hist.png",plot=p1 )
median(table(count_result))[1]
median(table(count_result))[1]
median(table(count_result))[[1]]
median(table(count_result))[[2]]
median(table(count_result))[[1]]
str(median(table(count_result)))
median(count_result_df)
count_result_df
View(udata)
names(count_result_df)
rownames(count_result_df)
count_result_df$id <- rownames(count_result_df)
colnames(count_result_df)
colnames(count_result_df)[1]
count_result_df <- data.frame(count_result)
colnames(count_result_df)[1] <-"Numb_of_Movies"
count_result_df$id <- rownames(count_result_df)
p1 <-ggplot(count_result_df, aes(Numb_of_Movies)) +geom_histogram(binwidth = 3)+
geom_vline(xintercept = 146,colour="steelblue",linetype = "longdash")+
ggtitle("Histogram of movie counts(bw=3)")
p1
ggsave("./image/week7_hist.png",plot=p1)
median(count_result_df$Numb_of_Movies)
movie_numb_median <- median(count_result_df$Numb_of_Movies)
p1 <-ggplot(count_result_df, aes(Numb_of_Movies)) +geom_histogram(binwidth = 3)+
geom_vline(xintercept = movie_numb_median,colour="steelblue",linetype = "longdash")+
ggtitle("Histogram of movie counts(bw=3)")
p1
ggsave("./image/week7_hist.png",plot=p1)
mean(count_result_df$Numb_of_Movies)
movie_numb_median
range(count_result_df$Numb_of_Movies)
u_id_1<-count_result_df[count_result_df$Numb_of_Movies<66,]$id
u_id_2<-count_result_df[count_result_df$Numb_of_Movies>65,]$id
